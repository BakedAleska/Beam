<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beam</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2>Beam</h2>
            </div>
            <ul class="nav-links">
                <li>
                    <a href="#api-reference" class="main-link">API Reference</a>
                    <ul class="sub-links">
                        <li>
                            <a href="#methods" class="sub-link">Methods</a>
                            <ul class="sub-sub-links">
                                <li><a href="#craft-entity">CraftEntity</a></li>
                                <li><a href="#register-body">RegisterBody</a></li>
                                <li><a href="#count">Count</a></li>
                                <li><a href="#kill">Kill</a></li>
                                <li><a href="#for-each">ForEach</a></li>
                                <li><a href="#assign-component">AssignComponent</a></li>
                                <li><a href="#unassign-component">UnassignComponent</a></li>
                                <li><a href="#return-entity">ReturnEntity</a></li>
                                <li><a href="#fire-event">FireEvent</a></li>
                                <li><a href="#read-entity-event">ReadEntityEvent</a></li>
                                <li><a href="#read-event">ReadEvent</a></li>
                                <li><a href="#subscribe-to">SubscribeTo</a></li>
                                <li><a href="#update">Update</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#properties" class="sub-link">Properties</a>
                            <ul class="sub-sub-links">
                                <li><a href="#components">Components</a></li>
                                <li><a href="#bodies">Bodies</a></li>
                                <li><a href="#alive">Alive</a></li>
                                <li><a href="#events">Events</a></li>
                                <li><a href="#next">Next</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#internals" class="sub-link">Internals</a>
                            <ul class="sub-sub-links">
                                <li><a href="#instance">Instance</a></li>
                                <li><a href="#cache">Cache</a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li><a href="#examples" class="main-link">Examples</a></li>
            </ul>
        </nav>
        
        <main class="content">
            <section id="api-reference">
                <h1>API Reference</h1>
                <p>Complete reference for the Beam API. Includes all methods and properties.</p>
            </section>
            
            <section id="methods">
                <h2>Methods</h2>
            </section>
            <section id="craft-entity">
                <h3>CraftEntity</h3>
                <div class="type-signature">
                    <code>CraftEntity: () ->  <span class="return-type">number</span></code>
                </div>
                <p>
                    Creates a new entity in the world, returning that entities id.
                </p>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Returns:</p>
                <div class="return-signature">
                    <div class="return-signature-items">
                        <div class="return-signature-item">
                            <span class="return-signature-item-type">number</span>
                            <span class="return-signature-item-desc">Entity ID - the unique identifier of the newly created entity</span>
                        </div>
                    </div>
                </div>
                <div class="method-divider"></div>
            </section>
            <section id="register-body">
                <h3>RegisterBody</h3>
                <div class="type-signature">
                    <code>RegisterBody: (<span class="parameter">Entity: number, Body: Instance</span>) -> ()</code>
                </div>
                <p>
                    Registers an entity-associated instance "Body", within <a class="property" href="#bodies">Bodies</a>,
                    making it easier to retrieve entity id's.
                </p>
                <div class="method-divider"></div>
            </section>
            <section id="count">
                <h3>Count</h3>
                <div class="type-signature">
                    <code>Count: (<span class="parameter">Components: { string }</span>) -> <span class="return-type">string?</span></code>
                </div>
                <p>
                    Returns the component, within a given table of components, which is associated with the smallest number of entities.
                    Used: primarily for fast, mutli-component access; alongside <a class="method" href="#for-each">ForEach</a>
                </p>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Returns:</p>
                <div class="return-signature">
                    <div class="return-signature-items">
                        <div class="return-signature-item">
                            <span class="return-signature-item-type">string?</span>
                            <span class="return-signature-item-desc">Component name - the component with the smallest entity count, or nil if none</span>
                        </div>
                    </div>
                </div>
                <div class="method-divider"></div>
            </section>
            <section id="kill">
                <h3>Kill</h3>
                <div class="type-signature">
                    <code>Kill: (<span class="parameter">Entity: number</span>) -> ()</code>
                </div>
                <p>
                    Destroys the specified entity.
                </p>
                <div class="method-divider"></div>
            </section>
            <section id="for-each">
                <h3>ForEach</h3>
                <div class="type-signature">
                    <code>ForEach: (<span class="parameter">Entity: number, Components: { string }</span>) -> (<span class="return-type">boolean, number?</span>)</code>
                </div>
                <p>
                    Iterates through <a class="property" href="#components">Components</a>, given an entity: and returns a 
                    boolean representing whether or not that entity has all the listed components. Depending on the case, returns an exit
                    value
                </p>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Returns:</p>
                <div class="return-signature">
                    <div class="return-signature-header">tuple</div>
                    <div class="return-signature-items">
                        <div class="return-signature-item">
                            <span class="return-signature-item-type">boolean</span>
                            <span class="return-signature-item-desc">Success - whether the entity has all components</span>
                        </div>
                        <div class="return-signature-item">
                            <span class="return-signature-item-type">number?</span>
                            <span class="return-signature-item-desc">Exitcode - 0: no such event, 1: event found, entity not in event.</span>
                        </div>
                    </div>
                </div>
                <div class="method-divider"></div>
            </section>
            <section id="assign-component">
                <h3>AssignComponent</h3>
                <div class="type-signature">AssignComponent: (<span class="parameter">Entity: number, Key: string, Data: { any }</span>) -> ()</div>
                <p>
                    Given an entity, a key (name for the component) and the components data, stores a component and its data in 
                    <a class="property" href="#components">Components</a>.
                </p>
                <div class="method-divider"></div>
            </section>
            <section id="unassign-component">
                <h3>UnassignComponent</h3>
                <div class="type-signature">
                    <code>UnassignComponent: (<span class="parameter">Entity: number, Key: string</span>) -> ()</code>
                </div>
                <p>
                    Removes a component from an entity by deleting it from the <a class="property" href="#components">Components</a> table.
                </p>
                <div class="method-divider"></div>
            </section>
            <section id="return-entity">
                <h3>ReturnEntity</h3>
                <div class="type-signature">
                    <code>ReturnEntity: (<span class="parameter">Reference: Instance</span>) -> <span class="return-type">number?</span></code>
                </div>
                <p>
                    Returns the entity ID associated with a given Instance from the <a class="property" href="#bodies">Bodies</a> table.
                </p>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Returns:</p>
                <div class="return-signature">
                    <div class="return-signature-items">
                        <div class="return-signature-item">
                            <span class="return-signature-item-type">number?</span>
                            <span class="return-signature-item-desc">Entity ID - the entity associated with the instance, or nil if not found</span>
                        </div>
                    </div>
                </div>
                <div class="method-divider"></div>
            </section>
            <section id="fire-event">
                <h3>FireEvent</h3>
                <div class="type-signature">
                    <code>FireEvent: (<span class="parameter">Event: event</span>) -> ()</code>
                </div>
                <p>
                    Fires an event to be processed in the next frame. The event is added to the <a class="property" href="#next">Next</a> event queue.
                </p>
                <div class="method-divider"></div>
            </section>
            <section id="read-entity-event">
                <h3>ReadEntityEvent</h3>
                <div class="type-signature">
                    <code>ReadEntityEvent: (<span class="parameter">Entity: number, Name: string</span>) -> (<span class="return-type">boolean, number?</span>)</code>
                </div>
                <p>
                    Checks if a specific entity has an event of the given name in the current <a class="property" href="#events">Events</a> table.
                </p>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Returns:</p>
                <div class="return-signature">
                    <div class="return-signature-header">tuple</div>
                    <div class="return-signature-items">
                        <div class="return-signature-item">
                            <span class="return-signature-item-type">boolean</span>
                            <span class="return-signature-item-desc">Found - whether the entity has the event</span>
                        </div>
                        <div class="return-signature-item">
                            <span class="return-signature-item-type">number?</span>
                            <span class="return-signature-item-desc">Status code - 0 if no event exists, 1 if event exists but entity not in it</span>
                        </div>
                    </div>
                </div>
                <div class="method-divider"></div>
            </section>
            <section id="read-event">
                <h3>ReadEvent</h3>
                <div class="type-signature">
                    <code>ReadEvent: (<span class="parameter">Name: string</span>) -> <span class="return-type">{ event }?</span></code>
                </div>
                <p>
                    Returns the event bucket for a given event name from the current <a class="property" href="#events">Events</a> table.
                </p>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Returns:</p>
                <div class="return-signature">
                    <div class="return-signature-items">
                        <div class="return-signature-item">
                            <span class="return-signature-item-type">{ event }?</span>
                            <span class="return-signature-item-desc">Event bucket - array of all events with that name, or nil if none</span>
                        </div>
                    </div>
                </div>
                <div class="method-divider"></div>
            </section>
            <section id="subscribe-to">
                <h3>SubscribeTo</h3>
                <div class="type-signature">
                    <code>SubscribeTo: (<span class="parameter">Event: string, Callback: (Entity: number, Data: any) -> ()</span>) -> ()</code>
                </div>
                <p>
                    Calls the provided callback for each entity that has the specified event in the current <a class="property" href="#events">Events</a> table.
                </p>
                <div class="method-divider"></div>
            </section>
            <section id="update">
                <h3>Update</h3>
                <div class="type-signature">
                    <code>Update: (<span class="parameter">dt: number</span>) -> ()</code>
                </div>
                <p>
                    Updates all systems and processes events. Should be called once per game frame. Swaps <a class="property" href="#events">Events</a> with <a class="property" href="#next">Next</a>, then clears the Next queue.
                </p>
                <div class="method-divider"></div>
            </section>
            
            <section id="properties">
                <h2>Properties</h2>
            </section>
                <div class="method-divider"></div>
            </section>
            
            <section id="bodies">
                <h3>Bodies</h3>
                <p>A global table that maps Instance objects to their associated entity IDs. Uses weak keys for automatic cleanup.</p>
                <div class="type-signature">
                    <code>Bodies: { <span class="parameter">[Instance]</span>: number }</code>
                </div>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Structure:</p>
                <div class="parameter-signature">
                    <div class="parameter-signature-header">Table Structure</div>
                    <div class="parameter-signature-items">
                        <div class="parameter-signature-item">
                            <span class="parameter-signature-item-type">[Instance]: number</span>
                            <span class="parameter-signature-item-desc">Instance reference mapped to entity ID</span>
                        </div>
                    </div>
                </div>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Note:</p>
                <p>
                    This table uses weak keys, meaning when an Instance is destroyed, the entry is automatically cleaned up. Use <a class="method" href="#return-entity">ReturnEntity</a> to look up entity IDs by Instance.
                </p>
                <div class="method-divider"></div>
            </section>
            <section id="alive">
                <h3>Alive</h3>
                <p>A global table that tracks which entities are currently alive in the world.</p>
                <div class="type-signature">
                    <code>Alive: { <span class="parameter">[number]</span>: boolean }</code>
                </div>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Structure:</p>
                <div class="parameter-signature">
                    <div class="parameter-signature-header">Table Structure</div>
                    <div class="parameter-signature-items">
                        <div class="parameter-signature-item">
                            <span class="parameter-signature-item-type">[number]: boolean</span>
                            <span class="parameter-signature-item-desc">Entity ID mapped to alive status (true = alive, nil = dead)</span>
                        </div>
                    </div>
                </div>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Note:</p>
                <p>
                    When an entity is killed via <a class="method" href="#kill">Kill</a>, its entry is removed from this table. Check this table to determine if an entity is still active.
                </p>
                <div class="method-divider"></div>
            </section>
            <section id="events">
                <h3>Events</h3>
                <p>A global table containing the current frame's events. Each event name maps to a bucket of all events with that name.</p>
                <div class="type-signature">
                    <code>Events: { <span class="parameter">[string]</span>: { event } }</code>
                </div>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Structure:</p>
                <div class="parameter-signature">
                    <div class="parameter-signature-header">Table Structure</div>
                    <div class="parameter-signature-items">
                        <div class="parameter-signature-item">
                            <span class="parameter-signature-item-type">[string]: array</span>
                            <span class="parameter-signature-item-desc">Event name mapped to array of events</span>
                        </div>
                        <div class="parameter-signature-item">
                            <span class="parameter-signature-item-type">array[n]: event</span>
                            <span class="parameter-signature-item-desc">Individual event objects sorted by priority</span>
                        </div>
                    </div>
                </div>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Note:</p>
                <p>
                    The Events table is swapped with <a class="property" href="#next">Next</a> during each <a class="method" href="#update">Update</a> call. Use <a class="method" href="#read-event">ReadEvent</a> or <a class="method" href="#read-entity-event">ReadEntityEvent</a> to query events safely.
                </p>
                <div class="method-divider"></div>
            </section>
            <section id="next">
                <h3>Next</h3>
                <p>A global table containing events queued for the next frame. Events are added here via <a class="method" href="#fire-event">FireEvent</a>.</p>
                <div class="type-signature">
                    <code>Next: { <span class="parameter">[string]</span>: { event } }</code>
                </div>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Structure:</p>
                <div class="parameter-signature">
                    <div class="parameter-signature-header">Table Structure</div>
                    <div class="parameter-signature-items">
                        <div class="parameter-signature-item">
                            <span class="parameter-signature-item-type">[string]: array</span>
                            <span class="parameter-signature-item-desc">Event name mapped to array of queued events</span>
                        </div>
                        <div class="parameter-signature-item">
                            <span class="parameter-signature-item-type">array[n]: event</span>
                            <span class="parameter-signature-item-desc">Individual event objects to be processed next frame</span>
                        </div>
                    </div>
                </div>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Note:</p>
                <p>
                    This table becomes the <a class="property" href="#events">Events</a> table during the next <a class="method" href="#update">Update</a> call. The current Events table then becomes Next.
                </p>
                <div class="method-divider"></div>
            </section>
            
            <section id="internals">
                <h2>Internals</h2>
            </section>
            <section id="instance">
                <h3>Instance</h3>
                <p>The singleton instance of the World. Stores the current active World object for global access.</p>
                <div class="type-signature">
                    <code>Instance: world?</code>
                </div>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Note:</p>
                <p>
                    This is set automatically when a new World is created via <code>World.new()</code>. It provides a global reference to the active World instance, allowing other systems to access the world without explicit parameter passing.
                </p>
                <div class="method-divider"></div>
            </section>
            <section id="cache">
                <h3>Cache</h3>
                <p>Caches loaded system modules for performance. Prevents redundant module loading during repeated <a class="method" href="#update">Update</a> calls.</p>
                <div class="type-signature">
                    <code>Cache: { any }?</code>
                </div>
                <p style="font-weight: 800; color: #e6edf3; margin-bottom: -0.5rem; padding-top: 30px;">Note:</p>
                <p>
                    The cache is populated lazily on the first <a class="method" href="#update">Update</a> call. It stores all system modules found in the Systems directory that have an Update function. Systems are sorted alphabetically by module name.
                </p>
                <div class="method-divider"></div>
            </section>
        </main>
    </div>
    
    <script src="script.js"></script>
</body>
</html>
